function selectUserButton(e){var t=$(e).attr("id");$("#quickUserSelect").val(t);selectButton(e)}function selectButton(e){$(e).siblings().removeClass("selected");$(e).addClass("selected")}function getFormattedRequestParameter(e,t){var n={};n["name"]=e;n["value"]=t;return n}function renderSimilarities(e){$("#similarityTypeOption").html("");$("#formWrapper").css("display","block");$.each(e,function(e,t){$("#similarityTypeOption").append('<span onclick="selectButton(this);" id="'+t.enumName+'" class="button">'+t.displayName+"</span>")})}function getRecommendationRequestParameters(e){var t=$("#recommendationTypeOption").find(".selected").attr("id");var n=$("#similarityTypeOption").find(".selected").attr("id");var r=$("#users").find(".selected").attr("id").replace("User ","");e.push(getFormattedRequestParameter("recommendationType",t),getFormattedRequestParameter("similarityMetric",n),getFormattedRequestParameter("userId",r));return e}function renderRecommendation(e){speedGauge.refresh(e.calculationTime);$("#recommendationResult").html("");$.each(e.recommendedItemList,function(e,t){e++;var n=t.itemID;$("#recommendationResult").append('<span class="button" id="'+n+'" '+">"+e+". Item "+n+" (Rating: "+t.value+")"+"</span>")})}function prepareRecommendedBecauseForItemBased(e){if(e.recommendationType=="ITEM_BASED"){$("#userId_recommendBecause").val(e.userId);$("#similarityType_recommendedBecause").val(e.appliedSimilarity.enumName);registerRecommendedBecauseAjaxEvent()}else{if(e.recommendationType=="USER_BASED"){$("#recommendationResult").find("span").addClass("staticButton")}}}function registerRecommendedBecauseAjaxEvent(){$("#recommendationResult").find("span").click(function(e){var t=$("#recommendedBecauseForm").attr("action");$.ajax({url:t,data:getRequestData($(this)),type:"GET",dataType:"JSON"}).done(function(e){renderRecommendedBecause(e);addFlipAnimation()});e.preventDefault()})}function renderRecommendedBecause(e){$("#recommendedBecause").html("");$("#recommendedBecause").prepend("<h3>Item "+e.recommendationParameters.itemId+" was recommended because:</h3>");$.each(e.recommendedItemList,function(e,t){e++;var n=t.itemID;$("#recommendedBecause").append('<span class="button staticButton" id="'+n+'">'+e+". Item "+n+" (Rating: "+t.value+")"+"</span>")})}function getRequestData(e){var t=$("#recommendedBecauseForm").serializeArray();var n=$(e).attr("id");t.push(getFormattedRequestParameter("itemId",n));return t}function addFlipAnimation(){$("#recommendedBecause").append('<span onclick="flipback();" class="button backButton">go back!</span>');$("#flipWrapper").flip({direction:"lr",content:$("#recommendedBecause"),speed:300,color:"rgba(140, 242, 255, 0.0)",onEnd:function(){registerRecommendedBecauseAjaxEvent()}});isFlipped=true}function flipback(){$("#flipWrapper").revertFlip();isFlipped=false}function sendAjax(){$.ajax({url:"/settings/because",type:"POST",data:$("#recommendationBecauseForm").serializeArray()}).done(function(){$("#settingsSuccess").css("display","inline").fadeOut(2500)}).fail(function(){$("#settingsFail").css("display","inline").fadeOut(2500)})}$(document).ready(function(){$("#recommendationTypeOption").find("span").click(function(e){var t=$(this).attr("id");$.ajax({url:"/similarityTyp",data:"recommendationType="+t,type:"GET",dataType:"JSON"}).done(function(e){renderSimilarities(e)});e.preventDefault()})});var isFlipped=false;$(document).ready(function(){$("#recommendationForm").submit(function(e){var t=getRecommendationRequestParameters($(this).serializeArray());var n=$(this).attr("action");$.ajax({url:n,type:"GET",dataType:"JSON",data:t}).done(function(e){if(isFlipped){flipback();setTimeout(function(){renderRecommendation(e);prepareRecommendedBecauseForItemBased(e.recommendationParameters)},e.calculationTime+1e3)}else{renderRecommendation(e);prepareRecommendedBecauseForItemBased(e.recommendationParameters)}});e.preventDefault()})});var keyUpTime=1e3;var keyUpTimeout=null;$("#howManyBecause").change(function(e){clearTimeout(keyUpTimeout);keyUpTimeout=setTimeout(function(){sendAjax()},keyUpTime);e.preventDefault()})
